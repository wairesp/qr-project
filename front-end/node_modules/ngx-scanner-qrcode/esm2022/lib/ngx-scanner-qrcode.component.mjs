import { Component, EventEmitter, ViewChild, ViewEncapsulation } from '@angular/core';
import { AsyncSubject, BehaviorSubject } from 'rxjs';
import { CANVAS_STYLES_LAYER, CANVAS_STYLES_TEXT, CONFIG_DEFAULT, MEDIA_STREAM_DEFAULT } from './ngx-scanner-qrcode.default';
import { AS_COMPLETE, BLOB_TO_FILE, CANVAS_TO_BLOB, DRAW_RESULT_APPEND_CHILD, FILES_TO_SCAN, OVERRIDES, PLAY_AUDIO, REMOVE_RESULT_PANEL, RESET_CANVAS, UPDATE_WIDTH_HEIGHT_VIDEO, VIBRATE, WASM_READY } from './ngx-scanner-qrcode.helper';
import { LOAD_WASM } from './ngx-scanner-qrcode.loader';
import * as i0 from "@angular/core";
class NgxScannerQrcodeComponent {
    constructor(renderer, elementRef) {
        this.renderer = renderer;
        this.elementRef = elementRef;
        /**
         * EventEmitter
         */
        this.event = new EventEmitter();
        /**
         * Input
         */
        this.src = CONFIG_DEFAULT.src;
        this.fps = CONFIG_DEFAULT.fps;
        this.vibrate = CONFIG_DEFAULT.vibrate;
        this.decode = CONFIG_DEFAULT.decode;
        this.isBeep = CONFIG_DEFAULT.isBeep;
        this.config = CONFIG_DEFAULT;
        this.constraints = CONFIG_DEFAULT.constraints;
        this.canvasStyles = [CANVAS_STYLES_LAYER, CANVAS_STYLES_TEXT];
        /**
         * Export
        */
        this.isStart = false;
        this.isPause = false;
        this.isLoading = false;
        this.isTorch = false;
        this.data = new BehaviorSubject([]);
        this.devices = new BehaviorSubject([]);
        this.deviceIndexActive = 0;
        this.dataForResize = [];
        this.ready = new AsyncSubject();
        this.STATUS = {
            startON: () => this.isStart = true,
            pauseON: () => this.isPause = true,
            loadingON: () => this.isLoading = true,
            startOFF: () => this.isStart = false,
            pauseOFF: () => this.isPause = false,
            loadingOFF: () => this.isLoading = false,
            torchOFF: () => this.isTorch = false,
        };
    }
    ngOnInit() {
        this.overrideConfig();
        LOAD_WASM(this.ready, this.renderer).subscribe(() => {
            if (this.src) {
                this.loadImage(this.src);
            }
            this.resize();
        });
    }
    /**
     * start
     * @param playDeviceCustom
     * @returns
     */
    start(playDeviceCustom) {
        const as = new AsyncSubject();
        if (this.isStart) {
            // Reject
            AS_COMPLETE(as, false);
        }
        else {
            // fix safari
            this.safariWebRTC(as, playDeviceCustom);
        }
        return as;
    }
    /**
     * stop
     * @returns
     */
    stop() {
        this.STATUS.pauseOFF();
        this.STATUS.startOFF();
        this.STATUS.torchOFF();
        this.STATUS.loadingOFF();
        const as = new AsyncSubject();
        try {
            clearTimeout(this.rAF_ID);
            this.video.nativeElement.srcObject.getTracks().forEach((track) => {
                track.stop();
                AS_COMPLETE(as, true);
            });
            this.dataForResize = [];
            RESET_CANVAS(this.canvas.nativeElement);
            REMOVE_RESULT_PANEL(this.resultsPanel.nativeElement);
        }
        catch (error) {
            AS_COMPLETE(as, false, error);
        }
        return as;
    }
    /**
     * play
     * @returns
     */
    play() {
        const as = new AsyncSubject();
        if (this.isPause) {
            this.video.nativeElement.play();
            this.STATUS.pauseOFF();
            this.requestAnimationFrame();
            AS_COMPLETE(as, true);
        }
        else {
            AS_COMPLETE(as, false);
        }
        return as;
    }
    /**
     * pause
     * @returns
     */
    pause() {
        const as = new AsyncSubject();
        if (this.isStart) {
            clearTimeout(this.rAF_ID);
            this.video.nativeElement.pause();
            this.STATUS.pauseON();
            AS_COMPLETE(as, true);
        }
        else {
            AS_COMPLETE(as, false);
        }
        return as;
    }
    /**
     * playDevice
     * @param deviceId
     * @param as
     * @returns
     */
    playDevice(deviceId, as = new AsyncSubject()) {
        const constraints = this.getConstraints();
        const existDeviceId = (this.isStart && constraints) ? constraints.deviceId !== deviceId : true;
        switch (true) {
            case deviceId === 'null' || deviceId === 'undefined' || !deviceId:
                stop();
                this.stop();
                AS_COMPLETE(as, false);
                break;
            case deviceId && existDeviceId:
                stop();
                this.stop();
                // Loading on
                this.STATUS.loadingON();
                this.deviceIndexActive = this.devices.value.findIndex((f) => f.deviceId === deviceId);
                const constraints = { ...this.constraints, audio: false, video: { deviceId: deviceId, ...this.constraints.video } };
                // MediaStream
                navigator.mediaDevices.getUserMedia(constraints).then((stream) => {
                    this.video.nativeElement.srcObject = stream;
                    this.video.nativeElement.onloadedmetadata = () => {
                        this.video.nativeElement.play();
                        this.requestAnimationFrame();
                        AS_COMPLETE(as, true);
                        this.STATUS.startON();
                        this.STATUS.loadingOFF();
                    };
                }).catch((error) => {
                    this.eventEmit(false);
                    AS_COMPLETE(as, false, error);
                    this.STATUS.startOFF();
                    this.STATUS.loadingOFF();
                });
                break;
            default:
                AS_COMPLETE(as, false);
                this.STATUS.loadingOFF();
                break;
        }
        return as;
    }
    /**
     * loadImage
     * @param src
     * @returns
     */
    loadImage(src) {
        const as = new AsyncSubject();
        // Loading on
        this.STATUS.startOFF();
        this.STATUS.loadingON();
        // Set the src of this Image object.
        const image = new Image();
        // Setting cross origin value to anonymous
        image.setAttribute('crossOrigin', 'anonymous');
        // When our image has loaded.
        image.onload = () => {
            WASM_READY() && this.drawImage(image, (flag) => {
                AS_COMPLETE(as, flag);
                this.STATUS.startOFF();
                this.STATUS.loadingOFF();
            });
        };
        // Set src
        image.src = src;
        return as;
    }
    /**
     * torcher
     * @returns
     */
    torcher() {
        const as = this.applyConstraints({ advanced: [{ torch: this.isTorch }] });
        as.subscribe(() => false, () => this.isTorch = !this.isTorch);
        return as;
    }
    /**
     * applyConstraints
     * @param constraints
     * @param deviceIndex
     * @returns
     */
    applyConstraints(constraints, deviceIndex = 0) {
        const as = new AsyncSubject();
        if (this.isStart) {
            const stream = this.video.nativeElement.srcObject;
            if (deviceIndex !== null || deviceIndex !== undefined || !Number.isNaN(deviceIndex)) {
                const videoTrack = stream.getVideoTracks()[deviceIndex];
                const imageCapture = new window.ImageCapture(videoTrack);
                imageCapture.getPhotoCapabilities().then(async () => {
                    await videoTrack.applyConstraints(constraints);
                    UPDATE_WIDTH_HEIGHT_VIDEO(this.video.nativeElement, this.canvas.nativeElement);
                    AS_COMPLETE(as, true);
                }).catch((error) => {
                    switch (error?.name) {
                        case 'NotFoundError':
                        case 'DevicesNotFoundError':
                            AS_COMPLETE(as, false, 'Required track is missing');
                            break;
                        case 'NotReadableError':
                        case 'TrackStartError':
                            AS_COMPLETE(as, false, 'Webcam or mic are already in use');
                            break;
                        case 'OverconstrainedError':
                        case 'ConstraintNotSatisfiedError':
                            AS_COMPLETE(as, false, 'Constraints can not be satisfied by avb. devices');
                            break;
                        case 'NotAllowedError':
                        case 'PermissionDeniedError':
                            AS_COMPLETE(as, false, 'Permission denied in browser');
                            break;
                        case 'TypeError':
                            AS_COMPLETE(as, false, 'Empty constraints object');
                            break;
                        default:
                            AS_COMPLETE(as, false, error);
                            break;
                    }
                });
            }
            else {
                AS_COMPLETE(as, false, 'Please check again deviceIndex');
            }
        }
        else {
            AS_COMPLETE(as, false, 'Please start the scanner');
        }
        return as;
    }
    ;
    /**
     * getConstraints
     * @param deviceIndex
     * @returns
     */
    getConstraints(deviceIndex = 0) {
        const stream = this.video.nativeElement.srcObject;
        const videoTrack = stream?.getVideoTracks()[deviceIndex];
        return videoTrack?.getConstraints();
    }
    /**
     * download
     * @param fileName
     * @param quality
     * @param type
     * @returns
     */
    download(fileName = `ngx_scanner_qrcode_${Date.now()}.png`, quality, type) {
        const as = new AsyncSubject();
        (async () => {
            const blob = await CANVAS_TO_BLOB(this.canvas.nativeElement);
            const file = BLOB_TO_FILE(blob, fileName);
            FILES_TO_SCAN([file], this.config, quality, type, as).subscribe((res) => {
                res.forEach((item) => {
                    if (item?.data?.length) {
                        const link = document.createElement('a');
                        link.href = item.url;
                        link.download = item.name;
                        link.click();
                        link.remove();
                    }
                });
            });
        })();
        return as;
    }
    /**
     * resize
     */
    resize() {
        window.addEventListener("resize", () => {
            DRAW_RESULT_APPEND_CHILD(this.dataForResize, this.canvas.nativeElement, this.resultsPanel.nativeElement, this.canvasStyles);
            UPDATE_WIDTH_HEIGHT_VIDEO(this.video.nativeElement, this.canvas.nativeElement);
        });
    }
    /**
     * overrideConfig
     */
    overrideConfig() {
        if ('src' in this.config)
            this.src = this.config.src;
        if ('fps' in this.config)
            this.fps = this.config.fps;
        if ('vibrate' in this.config)
            this.vibrate = this.config.vibrate;
        if ('decode' in this.config)
            this.decode = this.config.decode;
        if ('isBeep' in this.config)
            this.isBeep = this.config.isBeep;
        if ('constraints' in this.config)
            this.constraints = OVERRIDES('constraints', this.config, MEDIA_STREAM_DEFAULT);
        if ('canvasStyles' in this.config && this.config?.canvasStyles?.length === 2)
            this.canvasStyles = this.config.canvasStyles;
    }
    /**
     * safariWebRTC
     * Fix issue on safari
     * https://webrtchacks.com/guide-to-safari-webrtc
     * @param as
     * @param playDeviceCustom
     */
    safariWebRTC(as, playDeviceCustom) {
        // Loading on
        this.STATUS.startOFF();
        this.STATUS.loadingON();
        navigator.mediaDevices.getUserMedia(this.constraints).then((stream) => {
            stream.getTracks().forEach(track => track.stop());
            this.loadAllDevices(as, playDeviceCustom);
        }).catch((error) => {
            AS_COMPLETE(as, false, error);
            this.STATUS.startOFF();
            this.STATUS.loadingOFF();
        });
    }
    /**
     * loadAllDevices
     * @param as
     * @param playDeviceCustom
     */
    loadAllDevices(as, playDeviceCustom) {
        navigator.mediaDevices.enumerateDevices().then(devices => {
            let cameraDevices = devices.filter(f => f.kind == 'videoinput');
            this.devices.next(cameraDevices);
            if (cameraDevices?.length > 0) {
                AS_COMPLETE(as, cameraDevices);
                playDeviceCustom ? playDeviceCustom(cameraDevices) : this.playDevice(cameraDevices[0].deviceId);
            }
            else {
                AS_COMPLETE(as, false, 'No camera detected.');
                this.STATUS.startOFF();
                this.STATUS.loadingOFF();
            }
        }).catch((error) => {
            AS_COMPLETE(as, false, error);
            this.STATUS.startOFF();
            this.STATUS.loadingOFF();
        });
    }
    /**
     * drawImage
     * @param element
     * @param callback
     */
    async drawImage(element, callback = () => { }) {
        // Get the canvas element by using the getElementById method.
        const canvas = this.canvas.nativeElement;
        // Get a 2D drawing context for the canvas.
        const ctx = canvas.getContext('2d', { willReadFrequently: true });
        // HTMLImageElement size
        if (element instanceof HTMLImageElement) {
            canvas.width = element.naturalWidth;
            canvas.height = element.naturalHeight;
            element.style.visibility = '';
            this.video.nativeElement.style.visibility = 'hidden';
            // Image center and auto scale
            this.renderer.setStyle(this.elementRef.nativeElement, 'width', canvas.width + 'px');
            this.renderer.setStyle(this.elementRef.nativeElement, 'maxWidth', 100 + '%');
            this.renderer.setStyle(this.elementRef.nativeElement, 'display', 'inline-block');
        }
        // HTMLVideoElement size
        if (element instanceof HTMLVideoElement) {
            canvas.width = element.videoWidth;
            canvas.height = element.videoHeight;
            element.style.visibility = '';
            this.canvas.nativeElement.style.visibility = 'hidden';
        }
        // Set width, height for video element
        UPDATE_WIDTH_HEIGHT_VIDEO(this.video.nativeElement, canvas);
        // clear frame
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        // Draw image
        ctx.drawImage(element, 0, 0, canvas.width, canvas.height);
        // Data image
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        // Draw frame
        const code = await zbarWasm.scanImageData(imageData);
        if (code?.length) {
            // Decode
            code.forEach((s) => s.value = s.decode(this.decode?.toLocaleLowerCase()));
            // Overlay
            DRAW_RESULT_APPEND_CHILD(code, Object.freeze(this.canvas.nativeElement), this.resultsPanel.nativeElement, this.canvasStyles);
            // To blob and emit data
            const EMIT_DATA = () => {
                this.eventEmit(code);
                this.dataForResize = code;
            };
            // HTMLImageElement
            if (element instanceof HTMLImageElement) {
                callback(true);
                EMIT_DATA();
                VIBRATE(this.vibrate);
                PLAY_AUDIO(this.isBeep);
            }
            // HTMLVideoElement
            if (element instanceof HTMLVideoElement) {
                EMIT_DATA();
                VIBRATE(this.vibrate);
                PLAY_AUDIO(this.isBeep);
            }
        }
        else {
            callback(false);
            REMOVE_RESULT_PANEL(this.resultsPanel.nativeElement);
            this.dataForResize = [];
        }
    }
    /**
     * eventEmit
     * @param response
     */
    eventEmit(response = false) {
        (response !== false) && this.data.next(response || []);
        (response !== false) && this.event.emit(response || []);
    }
    /**
     * Single-thread
     * Loop Recording on Camera
     * Must be destroy request
     * Not using: requestAnimationFrame
     * @param delay
     */
    requestAnimationFrame(delay = 100) {
        try {
            clearTimeout(this.rAF_ID);
            this.rAF_ID = setTimeout(() => {
                if (this.video.nativeElement.readyState === this.video.nativeElement.HAVE_ENOUGH_DATA) {
                    delay = 0; // Appy first request
                    WASM_READY() && this.drawImage(this.video.nativeElement);
                    this.isStart && !this.isPause && this.requestAnimationFrame(delay);
                }
            }, /*avoid cache mediaStream*/ delay || this.fps);
        }
        catch (error) {
            clearTimeout(this.rAF_ID);
        }
    }
    /**
     * isReady
     */
    get isReady() {
        return this.ready;
    }
    ngOnDestroy() {
        this.pause();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.0.3", ngImport: i0, type: NgxScannerQrcodeComponent, deps: [{ token: i0.Renderer2 }, { token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.0.3", type: NgxScannerQrcodeComponent, selector: "ngx-scanner-qrcode", inputs: { src: "src", fps: "fps", vibrate: "vibrate", decode: "decode", isBeep: "isBeep", config: "config", constraints: "constraints", canvasStyles: "canvasStyles" }, outputs: { event: "event" }, host: { classAttribute: "ngx-scanner-qrcode" }, viewQueries: [{ propertyName: "video", first: true, predicate: ["video"], descendants: true }, { propertyName: "canvas", first: true, predicate: ["canvas"], descendants: true }, { propertyName: "resultsPanel", first: true, predicate: ["resultsPanel"], descendants: true }], exportAs: ["scanner"], ngImport: i0, template: `<div #resultsPanel class="origin-overlay"></div><canvas #canvas class="origin-canvas"></canvas><video #video playsinline class="origin-video"></video>`, isInline: true, styles: [".ngx-scanner-qrcode{display:block;position:relative}.origin-overlay{width:100%;position:absolute}.origin-overlay span{z-index:2;text-align:left;position:absolute}.origin-overlay .qrcode-polygon{z-index:1;position:absolute}.origin-canvas{width:100%;position:absolute}.origin-video{width:100%;background-color:#262626}.qrcode-tooltip{z-index:3;position:absolute}.qrcode-tooltip:hover .qrcode-tooltip-temp{display:block;position:absolute;cursor:copy}.qrcode-tooltip:hover .qrcode-tooltip-temp:active{color:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp{bottom:0;left:50%;color:#fff;text-align:left;display:none;width:max-content;word-wrap:break-word;transform:translate(-50%);transform-style:preserve-3d;background-color:#000000d0;box-shadow:1px 1px 20px #000000e0}.qrcode-tooltip .qrcode-tooltip-temp svg{cursor:pointer}.qrcode-tooltip .qrcode-tooltip-temp svg rect{fill:none;stroke:#fff;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg path{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg:active rect{stroke:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp svg:active path{stroke:#afafaf}\n"], encapsulation: i0.ViewEncapsulation.None }); }
}
export { NgxScannerQrcodeComponent };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.0.3", ngImport: i0, type: NgxScannerQrcodeComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ngx-scanner-qrcode', template: `<div #resultsPanel class="origin-overlay"></div><canvas #canvas class="origin-canvas"></canvas><video #video playsinline class="origin-video"></video>`, host: { 'class': 'ngx-scanner-qrcode' }, exportAs: 'scanner', inputs: ['src', 'fps', 'vibrate', 'decode', 'isBeep', 'config', 'constraints', 'canvasStyles'], outputs: ['event'], queries: {
                        video: new ViewChild('video'),
                        canvas: new ViewChild('canvas'),
                        resultsPanel: new ViewChild('resultsPanel')
                    }, encapsulation: ViewEncapsulation.None, styles: [".ngx-scanner-qrcode{display:block;position:relative}.origin-overlay{width:100%;position:absolute}.origin-overlay span{z-index:2;text-align:left;position:absolute}.origin-overlay .qrcode-polygon{z-index:1;position:absolute}.origin-canvas{width:100%;position:absolute}.origin-video{width:100%;background-color:#262626}.qrcode-tooltip{z-index:3;position:absolute}.qrcode-tooltip:hover .qrcode-tooltip-temp{display:block;position:absolute;cursor:copy}.qrcode-tooltip:hover .qrcode-tooltip-temp:active{color:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp{bottom:0;left:50%;color:#fff;text-align:left;display:none;width:max-content;word-wrap:break-word;transform:translate(-50%);transform-style:preserve-3d;background-color:#000000d0;box-shadow:1px 1px 20px #000000e0}.qrcode-tooltip .qrcode-tooltip-temp svg{cursor:pointer}.qrcode-tooltip .qrcode-tooltip-temp svg rect{fill:none;stroke:#fff;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg path{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg:active rect{stroke:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp svg:active path{stroke:#afafaf}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.Renderer2 }, { type: i0.ElementRef }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNjYW5uZXItcXJjb2RlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1zY2FubmVyLXFyY29kZS9zcmMvbGliL25neC1zY2FubmVyLXFyY29kZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBYyxZQUFZLEVBQWdDLFNBQVMsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNoSSxPQUFPLEVBQUUsWUFBWSxFQUFFLGVBQWUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNyRCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsa0JBQWtCLEVBQUUsY0FBYyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDN0gsT0FBTyxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsY0FBYyxFQUFFLHdCQUF3QixFQUFFLGFBQWEsRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLG1CQUFtQixFQUFFLFlBQVksRUFBRSx5QkFBeUIsRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDM08sT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLDZCQUE2QixDQUFDOztBQUl4RCxNQWVhLHlCQUF5QjtJQXVEcEMsWUFBb0IsUUFBbUIsRUFBVSxVQUFzQjtRQUFuRCxhQUFRLEdBQVIsUUFBUSxDQUFXO1FBQVUsZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQTdDdkU7O1dBRUc7UUFDSSxVQUFLLEdBQUcsSUFBSSxZQUFZLEVBQXlCLENBQUM7UUFFekQ7O1dBRUc7UUFDSSxRQUFHLEdBQXVCLGNBQWMsQ0FBQyxHQUFHLENBQUM7UUFDN0MsUUFBRyxHQUF1QixjQUFjLENBQUMsR0FBRyxDQUFDO1FBQzdDLFlBQU8sR0FBdUIsY0FBYyxDQUFDLE9BQU8sQ0FBQztRQUNyRCxXQUFNLEdBQXVCLGNBQWMsQ0FBQyxNQUFNLENBQUM7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QUFLLENBQUMsYUFBYSxDQUFDLENBQUM7b0JBQ3pELElBQUksQ0FBQyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDcEU7WUFDSCxDQUFDLEVBQUUsMkJBQTJCLENBQUMsS0FBSyxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUNuRDtRQUFDLE9BQU8sS0FBSyxFQUFFO1lBQ2QsWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUMzQjtJQUNILENBQUM7SUFFRDs7T0FFRztJQUNILElBQUksT0FBTztRQUNULE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQztJQUNwQixDQUFDO0lBRUQsV0FBVztRQUNULElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUNmLENBQUM7OEdBN2VVLHlCQUF5QjtrR0FBekIseUJBQXlCLHdsQkFiMUIsd0pBQXdKOztTQWF2Six5QkFBeUI7MkZBQXpCLHlCQUF5QjtrQkFmckMsU0FBUzsrQkFDRSxvQkFBb0IsWUFDcEIsd0pBQXdKLFFBRTVKLEVBQUUsT0FBTyxFQUFFLG9CQUFvQixFQUFFLFlBQzdCLFNBQVMsVUFDWCxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLGFBQWEsRUFBRSxjQUFjLENBQUMsV0FDckYsQ0FBQyxPQUFPLENBQUMsV0FDVDt3QkFDUCxLQUFLLEVBQUUsSUFBSSxTQUFTLENBQUMsT0FBTyxDQUFDO3dCQUM3QixNQUFNLEVBQUUsSUFBSSxTQUFTLENBQUMsUUFBUSxDQUFDO3dCQUMvQixZQUFZLEVBQUUsSUFBSSxTQUFTLENBQUMsY0FBYyxDQUFDO3FCQUM1QyxpQkFDYyxpQkFBaUIsQ0FBQyxJQUFJIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBFdmVudEVtaXR0ZXIsIE9uRGVzdHJveSwgT25Jbml0LCBSZW5kZXJlcjIsIFZpZXdDaGlsZCwgVmlld0VuY2Fwc3VsYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQXN5bmNTdWJqZWN0LCBCZWhhdmlvclN1YmplY3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgQ0FOVkFTX1NUWUxFU19MQVlFUiwgQ0FOVkFTX1NUWUxFU19URVhULCBDT05GSUdfREVGQVVMVCwgTUVESUFfU1RSRUFNX0RFRkFVTFQgfSBmcm9tICcuL25neC1zY2FubmVyLXFyY29kZS5kZWZhdWx0JztcclxuaW1wb3J0IHsgQVNfQ09NUExFVEUsIEJMT0JfVE9fRklMRSwgQ0FOVkFTX1RPX0JMT0IsIERSQVdfUkVTVUxUX0FQUEVORF9DSElMRCwgRklMRVNfVE9fU0NBTiwgT1ZFUlJJREVTLCBQTEFZX0FVRElPLCBSRU1PVkVfUkVTVUxUX1BBTkVMLCBSRVNFVF9DQU5WQVMsIFVQREFURV9XSURUSF9IRUlHSFRfVklERU8sIFZJQlJBVEUsIFdBU01fUkVBRFkgfSBmcm9tICcuL25neC1zY2FubmVyLXFyY29kZS5oZWxwZXInO1xyXG5pbXBvcnQgeyBMT0FEX1dBU00gfSBmcm9tICcuL25neC1zY2FubmVyLXFyY29kZS5sb2FkZXInO1xyXG5pbXBvcnQgeyBTY2FubmVyUVJDb2RlQ29uZmlnLCBTY2FubmVyUVJDb2RlRGV2aWNlLCBTY2FubmVyUVJDb2RlUmVzdWx0LCBTY2FubmVyUVJDb2RlU2VsZWN0ZWRGaWxlcyB9IGZyb20gJy4vbmd4LXNjYW5uZXItcXJjb2RlLm9wdGlvbnMnO1xyXG5kZWNsYXJlIHZhciB6YmFyV2FzbTogYW55O1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICduZ3gtc2Nhbm5lci1xcmNvZGUnLFxyXG4gIHRlbXBsYXRlOiBgPGRpdiAjcmVzdWx0c1BhbmVsIGNsYXNzPVwib3JpZ2luLW92ZXJsYXlcIj48L2Rpdj48Y2FudmFzICNjYW52YXMgY2xhc3M9XCJvcmlnaW4tY2FudmFzXCI+PC9jYW52YXM+PHZpZGVvICN2aWRlbyBwbGF5c2lubGluZSBjbGFzcz1cIm9yaWdpbi12aWRlb1wiPjwvdmlkZW8+YCxcclxuICBzdHlsZVVybHM6IFsnLi9uZ3gtc2Nhbm5lci1xcmNvZGUuY29tcG9uZW50LnNjc3MnXSxcclxuICBob3N0OiB7ICdjbGFzcyc6ICduZ3gtc2Nhbm5lci1xcmNvZGUnIH0sXHJcbiAgZXhwb3J0QXM6ICdzY2FubmVyJyxcclxuICBpbnB1dHM6IFsnc3JjJywgJ2ZwcycsICd2aWJyYXRlJywgJ2RlY29kZScsICdpc0JlZXAnLCAnY29uZmlnJywgJ2NvbnN0cmFpbnRzJywgJ2NhbnZhc1N0eWxlcyddLFxyXG4gIG91dHB1dHM6IFsnZXZlbnQnXSxcclxuICBxdWVyaWVzOiB7XHJcbiAgICB2aWRlbzogbmV3IFZpZXdDaGlsZCgndmlkZW8nKSxcclxuICAgIGNhbnZhczogbmV3IFZpZXdDaGlsZCgnY2FudmFzJyksXHJcbiAgICByZXN1bHRzUGFuZWw6IG5ldyBWaWV3Q2hpbGQoJ3Jlc3VsdHNQYW5lbCcpXHJcbiAgfSxcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBOZ3hTY2FubmVyUXJjb2RlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xyXG5cclxuICAvKipcclxuICAgKiBFbGVtZW50XHJcbiAgICogcGxheXNpbmxpbmUgcmVxdWlyZWQgdG8gdGVsbCBpT1Mgc2FmYXJpIHdlIGRvbid0IHdhbnQgZnVsbHNjcmVlblxyXG4gICAqL1xyXG4gIHB1YmxpYyB2aWRlbyE6IEVsZW1lbnRSZWY8SFRNTFZpZGVvRWxlbWVudD47XHJcbiAgcHVibGljIGNhbnZhcyE6IEVsZW1lbnRSZWY8SFRNTENhbnZhc0VsZW1lbnQ+O1xyXG4gIHB1YmxpYyByZXN1bHRzUGFuZWwhOiBFbGVtZW50UmVmPEhUTUxEaXZFbGVtZW50PjtcclxuXHJcbiAgLyoqXHJcbiAgICogRXZlbnRFbWl0dGVyXHJcbiAgICovXHJcbiAgcHVibGljIGV2ZW50ID0gbmV3IEV2ZW50RW1pdHRlcjxTY2FubmVyUVJDb2RlUmVzdWx0W10+KCk7XHJcblxyXG4gIC8qKlxyXG4gICAqIElucHV0XHJcbiAgICovXHJcbiAgcHVibGljIHNyYzogc3RyaW5nIHwgdW5kZWZpbmVkID0gQ09ORklHX0RFRkFVTFQuc3JjO1xyXG4gIHB1YmxpYyBmcHM6IG51bWJlciB8IHVuZGVmaW5lZCA9IENPTkZJR19ERUZBVUxULmZwcztcclxuICBwdWJsaWMgdmlicmF0ZTogbnVtYmVyIHwgdW5kZWZpbmVkID0gQ09ORklHX0RFRkFVTFQudmlicmF0ZTtcclxuICBwdWJsaWMgZGVjb2RlOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBDT05GSUdfREVGQVVMVC5kZWNvZGU7XHJcbiAgcHVibGljIGlzQmVlcDogYm9vbGVhbiB8IHVuZGVmaW5lZCA9IENPTkZJR19ERUZBVUxULmlzQmVlcDtcclxuICBwdWJsaWMgY29uZmlnOiBTY2FubmVyUVJDb2RlQ29uZmlnID0gQ09ORklHX0RFRkFVTFQ7XHJcbiAgcHVibGljIGNvbnN0cmFpbnRzOiBNZWRpYVN0cmVhbUNvbnN0cmFpbnRzIHwgYW55ID0gQ09ORklHX0RFRkFVTFQuY29uc3RyYWludHM7XHJcbiAgcHVibGljIGNhbnZhc1N0eWxlczogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEW10gfCBhbnlbXSA9IFtDQU5WQVNfU1RZTEVTX0xBWUVSLCBDQU5WQVNfU1RZTEVTX1RFWFRdO1xyXG5cclxuICAvKipcclxuICAgKiBFeHBvcnRcclxuICAqL1xyXG4gIHB1YmxpYyBpc1N0YXJ0OiBib29sZWFuID0gZmFsc2U7XHJcbiAgcHVibGljIGlzUGF1c2U6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBwdWJsaWMgaXNMb2FkaW5nOiBib29sZWFuID0gZmFsc2U7XHJcbiAgcHVibGljIGlzVG9yY2g6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBwdWJsaWMgZGF0YSA9IG5ldyBCZWhhdmlvclN1YmplY3Q8U2Nhbm5lclFSQ29kZVJlc3VsdFtdPihbXSk7XHJcbiAgcHVibGljIGRldmljZXMgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PFNjYW5uZXJRUkNvZGVEZXZpY2VbXT4oW10pO1xyXG4gIHB1YmxpYyBkZXZpY2VJbmRleEFjdGl2ZTogbnVtYmVyID0gMDtcclxuXHJcbiAgLyoqXHJcbiAgICogUHJpdmF0ZVxyXG4gICovXHJcbiAgcHJpdmF0ZSByQUZfSUQ6IGFueTtcclxuICBwcml2YXRlIGRhdGFGb3JSZXNpemU6IFNjYW5uZXJRUkNvZGVSZXN1bHRbXSA9IFtdO1xyXG4gIHByaXZhdGUgcmVhZHkgPSBuZXcgQXN5bmNTdWJqZWN0PGJvb2xlYW4+KCk7XHJcblxyXG4gIHByaXZhdGUgU1RBVFVTID0ge1xyXG4gICAgc3RhcnRPTjogKCkgPT4gdGhpcy5pc1N0YXJ0ID0gdHJ1ZSxcclxuICAgIHBhdXNlT046ICgpID0+IHRoaXMuaXNQYXVzZSA9IHRydWUsXHJcbiAgICBsb2FkaW5nT046ICgpID0+IHRoaXMuaXNMb2FkaW5nID0gdHJ1ZSxcclxuICAgIHN0YXJ0T0ZGOiAoKSA9PiB0aGlzLmlzU3RhcnQgPSBmYWxzZSxcclxuICAgIHBhdXNlT0ZGOiAoKSA9PiB0aGlzLmlzUGF1c2UgPSBmYWxzZSxcclxuICAgIGxvYWRpbmdPRkY6ICgpID0+IHRoaXMuaXNMb2FkaW5nID0gZmFsc2UsXHJcbiAgICB0b3JjaE9GRjogKCkgPT4gdGhpcy5pc1RvcmNoID0gZmFsc2UsXHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIsIHByaXZhdGUgZWxlbWVudFJlZjogRWxlbWVudFJlZikgeyB9XHJcblxyXG4gIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5vdmVycmlkZUNvbmZpZygpO1xyXG4gICAgTE9BRF9XQVNNKHRoaXMucmVhZHksIHRoaXMucmVuZGVyZXIpLnN1YnNjcmliZSgoKSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLnNyYykge1xyXG4gICAgICAgIHRoaXMubG9hZEltYWdlKHRoaXMuc3JjKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnJlc2l6ZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBzdGFydFxyXG4gICAqIEBwYXJhbSBwbGF5RGV2aWNlQ3VzdG9tIFxyXG4gICAqIEByZXR1cm5zIFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGFydChwbGF5RGV2aWNlQ3VzdG9tPzogRnVuY3Rpb24pOiBBc3luY1N1YmplY3Q8YW55PiB7XHJcbiAgICBjb25zdCBhcyA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpO1xyXG4gICAgaWYgKHRoaXMuaXNTdGFydCkge1xyXG4gICAgICAvLyBSZWplY3RcclxuICAgICAgQVNfQ09NUExFVEUoYXMsIGZhbHNlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIGZpeCBzYWZhcmlcclxuICAgICAgdGhpcy5zYWZhcmlXZWJSVEMoYXMsIHBsYXlEZXZpY2VDdXN0b20pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogc3RvcFxyXG4gICAqIEByZXR1cm5zIFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdG9wKCk6IEFzeW5jU3ViamVjdDxhbnk+IHtcclxuICAgIHRoaXMuU1RBVFVTLnBhdXNlT0ZGKCk7XHJcbiAgICB0aGlzLlNUQVRVUy5zdGFydE9GRigpO1xyXG4gICAgdGhpcy5TVEFUVVMudG9yY2hPRkYoKTtcclxuICAgIHRoaXMuU1RBVFVTLmxvYWRpbmdPRkYoKTtcclxuICAgIGNvbnN0IGFzID0gbmV3IEFzeW5jU3ViamVjdDxhbnk+KCk7XHJcbiAgICB0cnkge1xyXG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5yQUZfSUQpO1xyXG4gICAgICAodGhpcy52aWRlby5uYXRpdmVFbGVtZW50LnNyY09iamVjdCBhcyBNZWRpYVN0cmVhbSkuZ2V0VHJhY2tzKCkuZm9yRWFjaCgodHJhY2s6IE1lZGlhU3RyZWFtVHJhY2spID0+IHtcclxuICAgICAgICB0cmFjay5zdG9wKCk7XHJcbiAgICAgICAgQVNfQ09NUExFVEUoYXMsIHRydWUpO1xyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5kYXRhRm9yUmVzaXplID0gW107XHJcbiAgICAgIFJFU0VUX0NBTlZBUyh0aGlzLmNhbnZhcy5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgUkVNT1ZFX1JFU1VMVF9QQU5FTCh0aGlzLnJlc3VsdHNQYW5lbC5uYXRpdmVFbGVtZW50KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSwgZXJyb3IgYXMgYW55KTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHBsYXlcclxuICAgKiBAcmV0dXJucyBcclxuICAgKi9cclxuICBwdWJsaWMgcGxheSgpOiBBc3luY1N1YmplY3Q8YW55PiB7XHJcbiAgICBjb25zdCBhcyA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpO1xyXG4gICAgaWYgKHRoaXMuaXNQYXVzZSkge1xyXG4gICAgICB0aGlzLnZpZGVvLm5hdGl2ZUVsZW1lbnQucGxheSgpO1xyXG4gICAgICB0aGlzLlNUQVRVUy5wYXVzZU9GRigpO1xyXG4gICAgICB0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZSgpO1xyXG4gICAgICBBU19DT01QTEVURShhcywgdHJ1ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBBU19DT01QTEVURShhcywgZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogcGF1c2VcclxuICAgKiBAcmV0dXJucyBcclxuICAgKi9cclxuICBwdWJsaWMgcGF1c2UoKTogQXN5bmNTdWJqZWN0PGFueT4ge1xyXG4gICAgY29uc3QgYXMgPSBuZXcgQXN5bmNTdWJqZWN0PGFueT4oKTtcclxuICAgIGlmICh0aGlzLmlzU3RhcnQpIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuckFGX0lEKTtcclxuICAgICAgdGhpcy52aWRlby5uYXRpdmVFbGVtZW50LnBhdXNlKCk7XHJcbiAgICAgIHRoaXMuU1RBVFVTLnBhdXNlT04oKTtcclxuICAgICAgQVNfQ09NUExFVEUoYXMsIHRydWUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgQVNfQ09NUExFVEUoYXMsIGZhbHNlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHBsYXlEZXZpY2VcclxuICAgKiBAcGFyYW0gZGV2aWNlSWQgXHJcbiAgICogQHBhcmFtIGFzIFxyXG4gICAqIEByZXR1cm5zIFxyXG4gICAqL1xyXG4gIHB1YmxpYyBwbGF5RGV2aWNlKGRldmljZUlkOiBzdHJpbmcsIGFzOiBBc3luY1N1YmplY3Q8YW55PiA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpKTogQXN5bmNTdWJqZWN0PGFueT4ge1xyXG4gICAgY29uc3QgY29uc3RyYWludHMgPSB0aGlzLmdldENvbnN0cmFpbnRzKCk7XHJcbiAgICBjb25zdCBleGlzdERldmljZUlkID0gKHRoaXMuaXNTdGFydCAmJiBjb25zdHJhaW50cykgPyBjb25zdHJhaW50cy5kZXZpY2VJZCAhPT0gZGV2aWNlSWQgOiB0cnVlO1xyXG4gICAgc3dpdGNoICh0cnVlKSB7XHJcbiAgICAgIGNhc2UgZGV2aWNlSWQgPT09ICdudWxsJyB8fCBkZXZpY2VJZCA9PT0gJ3VuZGVmaW5lZCcgfHwgIWRldmljZUlkOlxyXG4gICAgICAgIHN0b3AoKTtcclxuICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICBBU19DT01QTEVURShhcywgZmFsc2UpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIGRldmljZUlkICYmIGV4aXN0RGV2aWNlSWQ6XHJcbiAgICAgICAgc3RvcCgpO1xyXG4gICAgICAgIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgIC8vIExvYWRpbmcgb25cclxuICAgICAgICB0aGlzLlNUQVRVUy5sb2FkaW5nT04oKTtcclxuICAgICAgICB0aGlzLmRldmljZUluZGV4QWN0aXZlID0gdGhpcy5kZXZpY2VzLnZhbHVlLmZpbmRJbmRleCgoZjogU2Nhbm5lclFSQ29kZURldmljZSkgPT4gZi5kZXZpY2VJZCA9PT0gZGV2aWNlSWQpO1xyXG4gICAgICAgIGNvbnN0IGNvbnN0cmFpbnRzID0geyAuLi50aGlzLmNvbnN0cmFpbnRzLCBhdWRpbzogZmFsc2UsIHZpZGVvOiB7IGRldmljZUlkOiBkZXZpY2VJZCwgLi4udGhpcy5jb25zdHJhaW50cy52aWRlbyB9IH07XHJcbiAgICAgICAgLy8gTWVkaWFTdHJlYW1cclxuICAgICAgICBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldFVzZXJNZWRpYShjb25zdHJhaW50cykudGhlbigoc3RyZWFtOiBNZWRpYVN0cmVhbSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy52aWRlby5uYXRpdmVFbGVtZW50LnNyY09iamVjdCA9IHN0cmVhbTtcclxuICAgICAgICAgIHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudC5vbmxvYWRlZG1ldGFkYXRhID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnZpZGVvLm5hdGl2ZUVsZW1lbnQucGxheSgpO1xyXG4gICAgICAgICAgICB0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZSgpO1xyXG4gICAgICAgICAgICBBU19DT01QTEVURShhcywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuU1RBVFVTLnN0YXJ0T04oKTtcclxuICAgICAgICAgICAgdGhpcy5TVEFUVVMubG9hZGluZ09GRigpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pLmNhdGNoKChlcnJvcjogYW55KSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmV2ZW50RW1pdChmYWxzZSk7XHJcbiAgICAgICAgICBBU19DT01QTEVURShhcywgZmFsc2UsIGVycm9yKTtcclxuICAgICAgICAgIHRoaXMuU1RBVFVTLnN0YXJ0T0ZGKCk7XHJcbiAgICAgICAgICB0aGlzLlNUQVRVUy5sb2FkaW5nT0ZGKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgQVNfQ09NUExFVEUoYXMsIGZhbHNlKTtcclxuICAgICAgICB0aGlzLlNUQVRVUy5sb2FkaW5nT0ZGKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBsb2FkSW1hZ2VcclxuICAgKiBAcGFyYW0gc3JjIFxyXG4gICAqIEByZXR1cm5zIFxyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2FkSW1hZ2Uoc3JjOiBzdHJpbmcpOiBBc3luY1N1YmplY3Q8YW55PiB7XHJcbiAgICBjb25zdCBhcyA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpO1xyXG4gICAgLy8gTG9hZGluZyBvblxyXG4gICAgdGhpcy5TVEFUVVMuc3RhcnRPRkYoKTtcclxuICAgIHRoaXMuU1RBVFVTLmxvYWRpbmdPTigpO1xyXG4gICAgLy8gU2V0IHRoZSBzcmMgb2YgdGhpcyBJbWFnZSBvYmplY3QuXHJcbiAgICBjb25zdCBpbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG4gICAgLy8gU2V0dGluZyBjcm9zcyBvcmlnaW4gdmFsdWUgdG8gYW5vbnltb3VzXHJcbiAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2Nyb3NzT3JpZ2luJywgJ2Fub255bW91cycpO1xyXG4gICAgLy8gV2hlbiBvdXIgaW1hZ2UgaGFzIGxvYWRlZC5cclxuICAgIGltYWdlLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgV0FTTV9SRUFEWSgpICYmIHRoaXMuZHJhd0ltYWdlKGltYWdlLCAoZmxhZzogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgIEFTX0NPTVBMRVRFKGFzLCBmbGFnKTtcclxuICAgICAgICB0aGlzLlNUQVRVUy5zdGFydE9GRigpO1xyXG4gICAgICAgIHRoaXMuU1RBVFVTLmxvYWRpbmdPRkYoKTtcclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gU2V0IHNyY1xyXG4gICAgaW1hZ2Uuc3JjID0gc3JjO1xyXG4gICAgcmV0dXJuIGFzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogdG9yY2hlclxyXG4gICAqIEByZXR1cm5zIFxyXG4gICAqL1xyXG4gIHB1YmxpYyB0b3JjaGVyKCk6IEFzeW5jU3ViamVjdDxhbnk+IHtcclxuICAgIGNvbnN0IGFzID0gdGhpcy5hcHBseUNvbnN0cmFpbnRzKHsgYWR2YW5jZWQ6IFt7IHRvcmNoOiB0aGlzLmlzVG9yY2ggfV0gfSk7XHJcbiAgICBhcy5zdWJzY3JpYmUoKCkgPT4gZmFsc2UsICgpID0+IHRoaXMuaXNUb3JjaCA9ICF0aGlzLmlzVG9yY2gpO1xyXG4gICAgcmV0dXJuIGFzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogYXBwbHlDb25zdHJhaW50c1xyXG4gICAqIEBwYXJhbSBjb25zdHJhaW50cyBcclxuICAgKiBAcGFyYW0gZGV2aWNlSW5kZXggXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgcHVibGljIGFwcGx5Q29uc3RyYWludHMoY29uc3RyYWludHM6IE1lZGlhVHJhY2tDb25zdHJhaW50U2V0IHwgTWVkaWFUcmFja0NvbnN0cmFpbnRzIHwgYW55LCBkZXZpY2VJbmRleCA9IDApOiBBc3luY1N1YmplY3Q8YW55PiB7XHJcbiAgICBjb25zdCBhcyA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpO1xyXG4gICAgaWYgKHRoaXMuaXNTdGFydCkge1xyXG4gICAgICBjb25zdCBzdHJlYW0gPSB0aGlzLnZpZGVvLm5hdGl2ZUVsZW1lbnQuc3JjT2JqZWN0IGFzIE1lZGlhU3RyZWFtO1xyXG4gICAgICBpZiAoZGV2aWNlSW5kZXggIT09IG51bGwgfHwgZGV2aWNlSW5kZXggIT09IHVuZGVmaW5lZCB8fCAhTnVtYmVyLmlzTmFOKGRldmljZUluZGV4KSkge1xyXG4gICAgICAgIGNvbnN0IHZpZGVvVHJhY2sgPSBzdHJlYW0uZ2V0VmlkZW9UcmFja3MoKVtkZXZpY2VJbmRleF0gYXMgTWVkaWFTdHJlYW1UcmFjaztcclxuICAgICAgICBjb25zdCBpbWFnZUNhcHR1cmUgPSBuZXcgKHdpbmRvdyBhcyBhbnkpLkltYWdlQ2FwdHVyZSh2aWRlb1RyYWNrKTtcclxuICAgICAgICBpbWFnZUNhcHR1cmUuZ2V0UGhvdG9DYXBhYmlsaXRpZXMoKS50aGVuKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgIGF3YWl0IHZpZGVvVHJhY2suYXBwbHlDb25zdHJhaW50cyhjb25zdHJhaW50cyk7XHJcbiAgICAgICAgICBVUERBVEVfV0lEVEhfSEVJR0hUX1ZJREVPKHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudCwgdGhpcy5jYW52YXMubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICBBU19DT01QTEVURShhcywgdHJ1ZSk7XHJcbiAgICAgICAgfSkuY2F0Y2goKGVycm9yOiBhbnkpID0+IHtcclxuICAgICAgICAgIHN3aXRjaCAoZXJyb3I/Lm5hbWUpIHtcclxuICAgICAgICAgICAgY2FzZSAnTm90Rm91bmRFcnJvcic6XHJcbiAgICAgICAgICAgIGNhc2UgJ0RldmljZXNOb3RGb3VuZEVycm9yJzpcclxuICAgICAgICAgICAgICBBU19DT01QTEVURShhcywgZmFsc2UsICdSZXF1aXJlZCB0cmFjayBpcyBtaXNzaW5nJyBhcyBzdHJpbmcpO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdOb3RSZWFkYWJsZUVycm9yJzpcclxuICAgICAgICAgICAgY2FzZSAnVHJhY2tTdGFydEVycm9yJzpcclxuICAgICAgICAgICAgICBBU19DT01QTEVURShhcywgZmFsc2UsICdXZWJjYW0gb3IgbWljIGFyZSBhbHJlYWR5IGluIHVzZScgYXMgc3RyaW5nKTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnT3ZlcmNvbnN0cmFpbmVkRXJyb3InOlxyXG4gICAgICAgICAgICBjYXNlICdDb25zdHJhaW50Tm90U2F0aXNmaWVkRXJyb3InOlxyXG4gICAgICAgICAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSwgJ0NvbnN0cmFpbnRzIGNhbiBub3QgYmUgc2F0aXNmaWVkIGJ5IGF2Yi4gZGV2aWNlcycgYXMgc3RyaW5nKTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnTm90QWxsb3dlZEVycm9yJzpcclxuICAgICAgICAgICAgY2FzZSAnUGVybWlzc2lvbkRlbmllZEVycm9yJzpcclxuICAgICAgICAgICAgICBBU19DT01QTEVURShhcywgZmFsc2UsICdQZXJtaXNzaW9uIGRlbmllZCBpbiBicm93c2VyJyBhcyBzdHJpbmcpO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdUeXBlRXJyb3InOlxyXG4gICAgICAgICAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSwgJ0VtcHR5IGNvbnN0cmFpbnRzIG9iamVjdCcgYXMgc3RyaW5nKTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICBBU19DT01QTEVURShhcywgZmFsc2UsIGVycm9yIGFzIGFueSk7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgQVNfQ09NUExFVEUoYXMsIGZhbHNlLCAnUGxlYXNlIGNoZWNrIGFnYWluIGRldmljZUluZGV4JyBhcyBzdHJpbmcpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBBU19DT01QTEVURShhcywgZmFsc2UsICdQbGVhc2Ugc3RhcnQgdGhlIHNjYW5uZXInIGFzIHN0cmluZyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXM7XHJcbiAgfTtcclxuXHJcbiAgLyoqXHJcbiAgICogZ2V0Q29uc3RyYWludHNcclxuICAgKiBAcGFyYW0gZGV2aWNlSW5kZXggXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgcHVibGljIGdldENvbnN0cmFpbnRzKGRldmljZUluZGV4ID0gMCk6IE1lZGlhVHJhY2tDb25zdHJhaW50U2V0IHwgTWVkaWFUcmFja0NvbnN0cmFpbnRzIHtcclxuICAgIGNvbnN0IHN0cmVhbSA9IHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudC5zcmNPYmplY3QgYXMgTWVkaWFTdHJlYW07XHJcbiAgICBjb25zdCB2aWRlb1RyYWNrID0gc3RyZWFtPy5nZXRWaWRlb1RyYWNrcygpW2RldmljZUluZGV4XSBhcyBNZWRpYVN0cmVhbVRyYWNrO1xyXG4gICAgcmV0dXJuIHZpZGVvVHJhY2s/LmdldENvbnN0cmFpbnRzKCkgYXMgTWVkaWFUcmFja0NvbnN0cmFpbnRzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZG93bmxvYWRcclxuICAgKiBAcGFyYW0gZmlsZU5hbWUgXHJcbiAgICogQHBhcmFtIHF1YWxpdHkgXHJcbiAgICogQHBhcmFtIHR5cGUgXHJcbiAgICogQHJldHVybnMgXHJcbiAgICovXHJcbiAgcHVibGljIGRvd25sb2FkKGZpbGVOYW1lOiBzdHJpbmcgPSBgbmd4X3NjYW5uZXJfcXJjb2RlXyR7RGF0ZS5ub3coKX0ucG5nYCwgcXVhbGl0eT86IG51bWJlciwgdHlwZT86IHN0cmluZyk6IEFzeW5jU3ViamVjdDxTY2FubmVyUVJDb2RlU2VsZWN0ZWRGaWxlc1tdPiB7XHJcbiAgICBjb25zdCBhcyA9IG5ldyBBc3luY1N1YmplY3Q8YW55PigpO1xyXG4gICAgKGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IENBTlZBU19UT19CTE9CKHRoaXMuY2FudmFzLm5hdGl2ZUVsZW1lbnQpO1xyXG4gICAgICBjb25zdCBmaWxlID0gQkxPQl9UT19GSUxFKGJsb2IsIGZpbGVOYW1lKTtcclxuICAgICAgRklMRVNfVE9fU0NBTihbZmlsZV0sIHRoaXMuY29uZmlnLCBxdWFsaXR5LCB0eXBlLCBhcykuc3Vic2NyaWJlKChyZXM6IFNjYW5uZXJRUkNvZGVTZWxlY3RlZEZpbGVzW10pID0+IHtcclxuICAgICAgICByZXMuZm9yRWFjaCgoaXRlbTogU2Nhbm5lclFSQ29kZVNlbGVjdGVkRmlsZXMpID0+IHtcclxuICAgICAgICAgIGlmIChpdGVtPy5kYXRhPy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgICAgICAgICAgbGluay5ocmVmID0gaXRlbS51cmw7XHJcbiAgICAgICAgICAgIGxpbmsuZG93bmxvYWQgPSBpdGVtLm5hbWU7XHJcbiAgICAgICAgICAgIGxpbmsuY2xpY2soKTtcclxuICAgICAgICAgICAgbGluay5yZW1vdmUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KSgpO1xyXG4gICAgcmV0dXJuIGFzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogcmVzaXplXHJcbiAgICovXHJcbiAgcHJpdmF0ZSByZXNpemUoKTogdm9pZCB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCAoKSA9PiB7XHJcbiAgICAgIERSQVdfUkVTVUxUX0FQUEVORF9DSElMRCh0aGlzLmRhdGFGb3JSZXNpemUgYXMgYW55LCB0aGlzLmNhbnZhcy5uYXRpdmVFbGVtZW50LCB0aGlzLnJlc3VsdHNQYW5lbC5uYXRpdmVFbGVtZW50LCB0aGlzLmNhbnZhc1N0eWxlcyk7XHJcbiAgICAgIFVQREFURV9XSURUSF9IRUlHSFRfVklERU8odGhpcy52aWRlby5uYXRpdmVFbGVtZW50LCB0aGlzLmNhbnZhcy5uYXRpdmVFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb3ZlcnJpZGVDb25maWdcclxuICAgKi9cclxuICBwcml2YXRlIG92ZXJyaWRlQ29uZmlnKCk6IHZvaWQge1xyXG4gICAgaWYgKCdzcmMnIGluIHRoaXMuY29uZmlnKSB0aGlzLnNyYyA9IHRoaXMuY29uZmlnLnNyYztcclxuICAgIGlmICgnZnBzJyBpbiB0aGlzLmNvbmZpZykgdGhpcy5mcHMgPSB0aGlzLmNvbmZpZy5mcHM7XHJcbiAgICBpZiAoJ3ZpYnJhdGUnIGluIHRoaXMuY29uZmlnKSB0aGlzLnZpYnJhdGUgPSB0aGlzLmNvbmZpZy52aWJyYXRlO1xyXG4gICAgaWYgKCdkZWNvZGUnIGluIHRoaXMuY29uZmlnKSB0aGlzLmRlY29kZSA9IHRoaXMuY29uZmlnLmRlY29kZTtcclxuICAgIGlmICgnaXNCZWVwJyBpbiB0aGlzLmNvbmZpZykgdGhpcy5pc0JlZXAgPSB0aGlzLmNvbmZpZy5pc0JlZXA7XHJcbiAgICBpZiAoJ2NvbnN0cmFpbnRzJyBpbiB0aGlzLmNvbmZpZykgdGhpcy5jb25zdHJhaW50cyA9IE9WRVJSSURFUygnY29uc3RyYWludHMnLCB0aGlzLmNvbmZpZywgTUVESUFfU1RSRUFNX0RFRkFVTFQpO1xyXG4gICAgaWYgKCdjYW52YXNTdHlsZXMnIGluIHRoaXMuY29uZmlnICYmIHRoaXMuY29uZmlnPy5jYW52YXNTdHlsZXM/Lmxlbmd0aCA9PT0gMikgdGhpcy5jYW52YXNTdHlsZXMgPSB0aGlzLmNvbmZpZy5jYW52YXNTdHlsZXM7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBzYWZhcmlXZWJSVENcclxuICAgKiBGaXggaXNzdWUgb24gc2FmYXJpXHJcbiAgICogaHR0cHM6Ly93ZWJydGNoYWNrcy5jb20vZ3VpZGUtdG8tc2FmYXJpLXdlYnJ0Y1xyXG4gICAqIEBwYXJhbSBhcyBcclxuICAgKiBAcGFyYW0gcGxheURldmljZUN1c3RvbSBcclxuICAgKi9cclxuICBwcml2YXRlIHNhZmFyaVdlYlJUQyhhczogQXN5bmNTdWJqZWN0PGFueT4sIHBsYXlEZXZpY2VDdXN0b20/OiBGdW5jdGlvbik6IHZvaWQge1xyXG4gICAgLy8gTG9hZGluZyBvblxyXG4gICAgdGhpcy5TVEFUVVMuc3RhcnRPRkYoKTtcclxuICAgIHRoaXMuU1RBVFVTLmxvYWRpbmdPTigpO1xyXG4gICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEodGhpcy5jb25zdHJhaW50cykudGhlbigoc3RyZWFtOiBNZWRpYVN0cmVhbSkgPT4ge1xyXG4gICAgICBzdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaCh0cmFjayA9PiB0cmFjay5zdG9wKCkpO1xyXG4gICAgICB0aGlzLmxvYWRBbGxEZXZpY2VzKGFzLCBwbGF5RGV2aWNlQ3VzdG9tKTtcclxuICAgIH0pLmNhdGNoKChlcnJvcjogYW55KSA9PiB7XHJcbiAgICAgIEFTX0NPTVBMRVRFKGFzLCBmYWxzZSwgZXJyb3IpO1xyXG4gICAgICB0aGlzLlNUQVRVUy5zdGFydE9GRigpO1xyXG4gICAgICB0aGlzLlNUQVRVUy5sb2FkaW5nT0ZGKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIGxvYWRBbGxEZXZpY2VzXHJcbiAgICogQHBhcmFtIGFzIFxyXG4gICAqIEBwYXJhbSBwbGF5RGV2aWNlQ3VzdG9tIFxyXG4gICAqL1xyXG4gIHByaXZhdGUgbG9hZEFsbERldmljZXMoYXM6IEFzeW5jU3ViamVjdDxhbnk+LCBwbGF5RGV2aWNlQ3VzdG9tPzogRnVuY3Rpb24pOiB2b2lkIHtcclxuICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcygpLnRoZW4oZGV2aWNlcyA9PiB7XHJcbiAgICAgIGxldCBjYW1lcmFEZXZpY2VzOiBTY2FubmVyUVJDb2RlRGV2aWNlW10gPSBkZXZpY2VzLmZpbHRlcihmID0+IGYua2luZCA9PSAndmlkZW9pbnB1dCcpO1xyXG4gICAgICB0aGlzLmRldmljZXMubmV4dChjYW1lcmFEZXZpY2VzKTtcclxuICAgICAgaWYgKGNhbWVyYURldmljZXM/Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICBBU19DT01QTEVURShhcywgY2FtZXJhRGV2aWNlcyk7XHJcbiAgICAgICAgcGxheURldmljZUN1c3RvbSA/IHBsYXlEZXZpY2VDdXN0b20oY2FtZXJhRGV2aWNlcykgOiB0aGlzLnBsYXlEZXZpY2UoY2FtZXJhRGV2aWNlc1swXS5kZXZpY2VJZCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgQVNfQ09NUExFVEUoYXMsIGZhbHNlLCAnTm8gY2FtZXJhIGRldGVjdGVkLicgYXMgYW55KTtcclxuICAgICAgICB0aGlzLlNUQVRVUy5zdGFydE9GRigpO1xyXG4gICAgICAgIHRoaXMuU1RBVFVTLmxvYWRpbmdPRkYoKTtcclxuICAgICAgfVxyXG4gICAgfSkuY2F0Y2goKGVycm9yOiBhbnkpID0+IHtcclxuICAgICAgQVNfQ09NUExFVEUoYXMsIGZhbHNlLCBlcnJvcik7XHJcbiAgICAgIHRoaXMuU1RBVFVTLnN0YXJ0T0ZGKCk7XHJcbiAgICAgIHRoaXMuU1RBVFVTLmxvYWRpbmdPRkYoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZHJhd0ltYWdlXHJcbiAgICogQHBhcmFtIGVsZW1lbnQgXHJcbiAgICogQHBhcmFtIGNhbGxiYWNrIFxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZHJhd0ltYWdlKGVsZW1lbnQ6IEhUTUxJbWFnZUVsZW1lbnQgfCBIVE1MVmlkZW9FbGVtZW50LCBjYWxsYmFjazogRnVuY3Rpb24gPSAoKSA9PiB7IH0pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIC8vIEdldCB0aGUgY2FudmFzIGVsZW1lbnQgYnkgdXNpbmcgdGhlIGdldEVsZW1lbnRCeUlkIG1ldGhvZC5cclxuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuY2FudmFzLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAvLyBHZXQgYSAyRCBkcmF3aW5nIGNvbnRleHQgZm9yIHRoZSBjYW52YXMuXHJcbiAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnLCB7IHdpbGxSZWFkRnJlcXVlbnRseTogdHJ1ZSB9KSBhcyBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcbiAgICAvLyBIVE1MSW1hZ2VFbGVtZW50IHNpemVcclxuICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCkge1xyXG4gICAgICBjYW52YXMud2lkdGggPSBlbGVtZW50Lm5hdHVyYWxXaWR0aDtcclxuICAgICAgY2FudmFzLmhlaWdodCA9IGVsZW1lbnQubmF0dXJhbEhlaWdodDtcclxuICAgICAgZWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJyc7XHJcbiAgICAgIHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XHJcbiAgICAgIC8vIEltYWdlIGNlbnRlciBhbmQgYXV0byBzY2FsZVxyXG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCBjYW52YXMud2lkdGggKyAncHgnKTtcclxuICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgJ21heFdpZHRoJywgMTAwICsgJyUnKTtcclxuICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgJ2Rpc3BsYXknLCAnaW5saW5lLWJsb2NrJyk7XHJcbiAgICB9XHJcbiAgICAvLyBIVE1MVmlkZW9FbGVtZW50IHNpemVcclxuICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTFZpZGVvRWxlbWVudCkge1xyXG4gICAgICBjYW52YXMud2lkdGggPSBlbGVtZW50LnZpZGVvV2lkdGg7XHJcbiAgICAgIGNhbnZhcy5oZWlnaHQgPSBlbGVtZW50LnZpZGVvSGVpZ2h0O1xyXG4gICAgICBlbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAnJztcclxuICAgICAgdGhpcy5jYW52YXMubmF0aXZlRWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XHJcbiAgICB9XHJcbiAgICAvLyBTZXQgd2lkdGgsIGhlaWdodCBmb3IgdmlkZW8gZWxlbWVudFxyXG4gICAgVVBEQVRFX1dJRFRIX0hFSUdIVF9WSURFTyh0aGlzLnZpZGVvLm5hdGl2ZUVsZW1lbnQsIGNhbnZhcyk7XHJcbiAgICAvLyBjbGVhciBmcmFtZVxyXG4gICAgY3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpXHJcbiAgICAvLyBEcmF3IGltYWdlXHJcbiAgICBjdHguZHJhd0ltYWdlKGVsZW1lbnQsIDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcbiAgICAvLyBEYXRhIGltYWdlXHJcbiAgICBjb25zdCBpbWFnZURhdGEgPSBjdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcbiAgICAvLyBEcmF3IGZyYW1lXHJcbiAgICBjb25zdCBjb2RlID0gYXdhaXQgemJhcldhc20uc2NhbkltYWdlRGF0YShpbWFnZURhdGEpO1xyXG4gICAgaWYgKGNvZGU/Lmxlbmd0aCkge1xyXG4gICAgICAvLyBEZWNvZGVcclxuICAgICAgY29kZS5mb3JFYWNoKChzOiBhbnkpID0+IHMudmFsdWUgPSBzLmRlY29kZSh0aGlzLmRlY29kZT8udG9Mb2NhbGVMb3dlckNhc2UoKSkpO1xyXG4gICAgICAvLyBPdmVybGF5XHJcbiAgICAgIERSQVdfUkVTVUxUX0FQUEVORF9DSElMRChjb2RlLCBPYmplY3QuZnJlZXplKHRoaXMuY2FudmFzLm5hdGl2ZUVsZW1lbnQpLCB0aGlzLnJlc3VsdHNQYW5lbC5uYXRpdmVFbGVtZW50LCB0aGlzLmNhbnZhc1N0eWxlcyk7XHJcbiAgICAgIC8vIFRvIGJsb2IgYW5kIGVtaXQgZGF0YVxyXG4gICAgICBjb25zdCBFTUlUX0RBVEEgPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5ldmVudEVtaXQoY29kZSk7XHJcbiAgICAgICAgdGhpcy5kYXRhRm9yUmVzaXplID0gY29kZTtcclxuICAgICAgfTtcclxuICAgICAgLy8gSFRNTEltYWdlRWxlbWVudFxyXG4gICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQpIHtcclxuICAgICAgICBjYWxsYmFjayh0cnVlKTtcclxuICAgICAgICBFTUlUX0RBVEEoKTtcclxuICAgICAgICBWSUJSQVRFKHRoaXMudmlicmF0ZSk7XHJcbiAgICAgICAgUExBWV9BVURJTyh0aGlzLmlzQmVlcCk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gSFRNTFZpZGVvRWxlbWVudFxyXG4gICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxWaWRlb0VsZW1lbnQpIHtcclxuICAgICAgICBFTUlUX0RBVEEoKTtcclxuICAgICAgICBWSUJSQVRFKHRoaXMudmlicmF0ZSk7XHJcbiAgICAgICAgUExBWV9BVURJTyh0aGlzLmlzQmVlcCk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNhbGxiYWNrKGZhbHNlKTtcclxuICAgICAgUkVNT1ZFX1JFU1VMVF9QQU5FTCh0aGlzLnJlc3VsdHNQYW5lbC5uYXRpdmVFbGVtZW50KTtcclxuICAgICAgdGhpcy5kYXRhRm9yUmVzaXplID0gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBldmVudEVtaXRcclxuICAgKiBAcGFyYW0gcmVzcG9uc2UgXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBldmVudEVtaXQocmVzcG9uc2U6IGFueSA9IGZhbHNlKTogdm9pZCB7XHJcbiAgICAocmVzcG9uc2UgIT09IGZhbHNlKSAmJiB0aGlzLmRhdGEubmV4dChyZXNwb25zZSB8fCBbXSk7XHJcbiAgICAocmVzcG9uc2UgIT09IGZhbHNlKSAmJiB0aGlzLmV2ZW50LmVtaXQocmVzcG9uc2UgfHwgW10pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2luZ2xlLXRocmVhZFxyXG4gICAqIExvb3AgUmVjb3JkaW5nIG9uIENhbWVyYVxyXG4gICAqIE11c3QgYmUgZGVzdHJveSByZXF1ZXN0IFxyXG4gICAqIE5vdCB1c2luZzogcmVxdWVzdEFuaW1hdGlvbkZyYW1lXHJcbiAgICogQHBhcmFtIGRlbGF5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZGVsYXk6IG51bWJlciA9IDEwMCk6IHZvaWQge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuckFGX0lEKTtcclxuICAgICAgdGhpcy5yQUZfSUQgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy52aWRlby5uYXRpdmVFbGVtZW50LnJlYWR5U3RhdGUgPT09IHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudC5IQVZFX0VOT1VHSF9EQVRBKSB7XHJcbiAgICAgICAgICBkZWxheSA9IDA7IC8vIEFwcHkgZmlyc3QgcmVxdWVzdFxyXG4gICAgICAgICAgV0FTTV9SRUFEWSgpICYmIHRoaXMuZHJhd0ltYWdlKHRoaXMudmlkZW8ubmF0aXZlRWxlbWVudCk7XHJcbiAgICAgICAgICB0aGlzLmlzU3RhcnQgJiYgIXRoaXMuaXNQYXVzZSAmJiB0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZShkZWxheSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAvKmF2b2lkIGNhY2hlIG1lZGlhU3RyZWFtKi8gZGVsYXkgfHwgdGhpcy5mcHMpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuckFGX0lEKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIGlzUmVhZHlcclxuICAgKi9cclxuICBnZXQgaXNSZWFkeSgpOiBBc3luY1N1YmplY3Q8Ym9vbGVhbj4ge1xyXG4gICAgcmV0dXJuIHRoaXMucmVhZHk7XHJcbiAgfVxyXG5cclxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcclxuICAgIHRoaXMucGF1c2UoKTtcclxuICB9XHJcbn1cclxuIl19